/**
 * @license almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

!function(){var e,t,n;!function(i){function r(e,t){return w.call(e,t)}function o(e,t){var n,i,r,o,s,a,u,c,p,f,l=t&&t.split("/"),d=y.map,h=d&&d["*"]||{};if(e&&"."===e.charAt(0))if(t){for(l=l.slice(0,l.length-1),e=l.concat(e.split("/")),c=0;c<e.length;c+=1)if(f=e[c],"."===f)e.splice(c,1),c-=1;else if(".."===f){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((l||h)&&d){for(n=e.split("/"),c=n.length;c>0;c-=1){if(i=n.slice(0,c).join("/"),l)for(p=l.length;p>0;p-=1)if(r=d[l.slice(0,p).join("/")],r&&(r=r[i])){o=r,s=c;break}if(o)break;!a&&h&&h[i]&&(a=h[i],u=c)}!o&&a&&(o=a,s=u),o&&(n.splice(0,s,o),e=n.join("/"))}return e}function s(e,t){return function(){return d.apply(i,N.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return o(t,e)}}function u(e){return function(t){v[e]=t}}function c(e){if(r(m,e)){var t=m[e];delete m[e],b[e]=!0,l.apply(i,t)}if(!r(v,e)&&!r(b,e))throw new Error("No "+e);return v[e]}function p(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function f(e){return function(){return y&&y.config&&y.config[e]||{}}}var l,d,h,g,v={},m={},y={},b={},w=Object.prototype.hasOwnProperty,N=[].slice;h=function(e,t){var n,i=p(e),r=i[0];return e=i[1],r&&(r=o(r,t),n=c(r)),r?e=n&&n.normalize?n.normalize(e,a(t)):o(e,t):(e=o(e,t),i=p(e),r=i[0],e=i[1],r&&(n=c(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},g={require:function(e){return s(e)},exports:function(e){var t=v[e];return"undefined"!=typeof t?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:f(e)}}},l=function(e,t,n,o){var a,p,f,l,d,y,w=[];if(o=o||e,"function"==typeof n){for(t=!t.length&&n.length?["require","exports","module"]:t,d=0;d<t.length;d+=1)if(l=h(t[d],o),p=l.f,"require"===p)w[d]=g.require(e);else if("exports"===p)w[d]=g.exports(e),y=!0;else if("module"===p)a=w[d]=g.module(e);else if(r(v,p)||r(m,p)||r(b,p))w[d]=c(p);else{if(!l.p)throw new Error(e+" missing "+p);l.p.load(l.n,s(o,!0),u(p),{}),w[d]=v[p]}f=n.apply(v[e],w),e&&(a&&a.exports!==i&&a.exports!==v[e]?v[e]=a.exports:f===i&&y||(v[e]=f))}else e&&(v[e]=n)},e=t=d=function(e,t,n,r,o){return"string"==typeof e?g[e]?g[e](t):c(h(e,t).f):(e.splice||(y=e,t.splice?(e=t,t=n,n=null):e=i),t=t||function(){},"function"==typeof n&&(n=r,r=o),r?l(i,e,t,n):setTimeout(function(){l(i,e,t,n)},4),d)},d.config=function(e){return y=e,y.deps&&d(y.deps,y.callback),d},e._defined=v,n=function(e,t,n){t.splice||(n=t,t=[]),r(v,e)||r(m,e)||(m[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("vendor/require/almond.js",function(){}),function(e,t,i){"function"==typeof n&&n.amd?n("framework",[],function(){return e[i]=t()}):"object"==typeof module&&module.exports?module.exports=e[i]=t():e[i]=t()}(this,function(){var e=!0;return function(){var t,n,i,r,o,s,a,u,c,p,f,l,d;t=function(){var e,t,n={},i={init:function(e){console.log("init:",window._?"LODASH/UNDERSCORE!":"(no lodash/underscore)"),n=e||window._||n,t.extend(t,n)},clone:function(e,n,r,o,s){n=n||(t.isArray(e)?[]:{}),o=o||t.noop;for(var a in e)!e.hasOwnProperty(a)||s&&!t.isUndefined(n[a])||(n[a]=r&&t.isObject(e[a])?i.clone(e[a],null,!0):o(e[a],a,n));return n},cloneDeep:function(e,t,n){return i.clone(e,t,!0,n)},cookie:function(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""},defaults:function(e,t,n){return i.clone(t,e,!!n,null,!0)},defaultsDeep:function(e,t){return i.defaults(e,t,!0)},each:function(e,n,i){if(t.isArray(e))e.forEach(n.bind(i||window));else for(var r in e)n.bind(i||window)(e[r],r,e)},extend:function(e,t,n){return i.clone(t,e,!!n)},filter:function(e,t,n){var r=[];for(var o in e)if(i.isEqual(e[o],t,o)&&(r.push(e[o]),n))break;return n?r[0]:r},find:function(e,n){return t.filter(e,n,!0)},findWhere:function(e,n){return t.find(e,n)},get:function(e,n,i){var r,o=e.hasOwnProperty(n)?[n]:t.isArray(n)?n:n.split(/[\[\].:]+/),s=function(e,n,o,s){return"*"===n&&t.isObject(e)?Object.keys(e).reduce(function(n,i){r=!0;var a=t.get(e[i],s.slice(o+1));return t.isUndefined(a)?n:n.concat(a)},[]):e===i||t.isUndefined(e[n])?r&&e.length?e:i:e[n]};return o.reduce(s,e)},getProp:function(e,n){var i=t.isArray(n)?n:n.split(":"),r=i.slice(-1)[0],o={};return o[r]=t.get(e,i.join(".")),o},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isBoolean:function(e){return"boolean"==typeof e},isDomSelection:function(e){return t.isNodeList(e)||t.isNode(e)||t.isJquery(e)},isEqual:function(e,n,r){if(!t.isObject(e)&&!t.isFunction(n)&&typeof e!=typeof n)return!1;if(t.isBoolean(n))return!!e===n;if(t.isFunction(n))return n(e,isNaN(r)?r:+r);if(t.isObject(n)){for(var o in n)if(n.hasOwnProperty(o)&&(!e.hasOwnProperty(o)||!i.isEqual(e[o],n[o])))return!1;return!0}return t.isObject(e)?e[n]:e===n},isFunction:function(e){return"function"==typeof e},isIE:function(){return"function"==typeof ScriptEngineMajorVersion?ScriptEngineMajorVersion():void 0}(),isJquery:function(e){return window.jQuery&&e instanceof window.jQuery},isNode:function(e){return"[object HTMLElement]"===Object.prototype.toString.call(e)},isNodeList:function(e){return"[object NodeList]"===Object.prototype.toString.call(e)},isObject:function(e,t){return t?"[object Object]"===Object.prototype.toString.call(e):"object"==typeof e},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},isString:function(e){return"string"==typeof e},isUndefined:function(e){return"undefined"==typeof e},noop:function(e){return e},object:function(e,n){var i=t.isArray(e[0]);return e.reduce(function(e,t,r){return e[i?t[0]:t]=i?t[1]:n[r],e},{})},omit:function(e,n){return t.pick2(e,t.isArray(n)?n:t.toArray(arguments).slice(1),!0)},pick:function(e,n){return t.pick2(e,t.isArray(n)?n:t.toArray(arguments).slice(1))},pick2:function(e,t,n){return Object.keys(e).reduce(function(i,r){var o=t.indexOf(r)>=0;return(o&&!n||!o&&n)&&(i[r]=e[r]),i},{})},randomString:function(e){return Array(e+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,e)},serialise:function(e,t){var n=[];for(var i in e)if(e.hasOwnProperty(i)){var r=t?t+"["+i+"]":i,o=e[i];n.push("object"==typeof o?this.serialise(o,r):encodeURIComponent(r)+"="+encodeURIComponent(o))}return n.join("&")},storage:function(e){var t=new Date,n=function(t,n){this.data=function(t,n){try{var i=e[t+"Storage"];i.setItem(n,n);var r=i.getItem(n)==n;return i.removeItem(n),r&&i}catch(e){}}(t,n),this.setItem=function(e,t){this.data&&this.data.setItem(e,JSON.stringify(t))},this.getItem=function(e,t){if(this.data){var n=this.data.getItem(e);return t!==!1?JSON.parse(n):n}},this.removeItem=function(e){this.data&&this.data.removeItem(e)}};return{local:new n("local",t),session:new n("session",t)}}(window),template:function(n){var i=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"',$1,'").replace(/{{(.+?)}}/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+"');}return p.join('');"):e[n]=e[n]||this.template($(n)[0].innerHTML);return function(e){return i(t.defaults(e,{_:t}))}},toArray:function(e){return[].slice.call(e)},uniq:function(e){return e.filter(function(e,t,n){return n.indexOf(e)===t})},xpathToSelector:function(e){return e.replace(/^xpath:\/\//,"").split("/").reduce(function(e,t){return e.concat(t.replace(/\[(\d+)\]|$/,function(e,t){return":nth-of-type("+(t||1)+")"}))},[]).join(" ")}};t={};for(var r in i)!function(e){Object.defineProperty(t,e,{get:function(){return n[e]||i[e]}})}(r);return t}(),n=function(e){var t={$event:window,props:{},data:{},init:function(n,i,r){this.props.hasOwnProperty(n)||(this.data[n]={},this.props[n]={});var o=this.props[n],s=this.data[n],a={on:function(i,r){return e.each(i.split(" "),function(e){return":"===e.slice(0,1)?t.on(t.event(e.slice(1)),r):void t.on(t.event(n,e),r)}),a},off:function(i){return e.each(i.split(" "),function(e){e=":"===e.slice(0,1)?t.event(e.slice(1)):t.event(n,i),t.off(e)}),a},get:function(n){return":"===n.slice(0,1)?t.get(n.slice(1)):n.split(":").reduce(function(t,n){return e.isUndefined(t)?t:t[n]},s)},set:function(n,i,r){e.isString(n)?n=e.object([n],[i]):r=i;return e.each(n,function(n,i){if(":"===i.slice(0,1))return t.get(i.slice(1),n,r);var u,c=i.split(":"),p=c.shift(),f=c.length?e.isObject(s[p])?s[p]:{}:n;s.hasOwnProperty(p)||(r!==!0&&(u=!1),Object.defineProperty(o,p,{enumerable:!0,configurable:!0,get:function(){return s[p]},set:function(e){s[p]!==e&&(s[p]=e,a.history(p,e),a.trigger(p))}})),c.length?c.reduce(function(t,i,r){return r+1<c.length?(e.isObject(t[i])||(t[i]={}),t[i]):(e.isUndefined(t)&&(t={}),e.isUndefined(u)&&(u=t[i]!==n),t[i]=n,void 0)},f):e.isUndefined(u)&&(u=s[p]!==f),s[p]=f,a.history(p,f),(r===!0||u&&r!==!1)&&a.trigger(i)}),a},trigger:function(i){e.isString(i)&&(i=[i]);var r=e.toArray(arguments).slice(1);return e.each(i,function(i){a.history(i,r,!0),e.each(i.split(":"),function(i,o,u){var c=u.slice(0,u.length-o),p=c.join(":"),f=e.getProp(s,c),l=r.length?r:[f[c.slice(-1)[0]]],d=":"===p.slice(0,1)?t.event(p.slice(1)):t.event(n,p);l=1===l.length?l.concat(f,a):l.concat(a),t.$event.trigger(d,l)})}),a},unset:function(i){e.isString(i)&&(i=[i]),e.each(i,function(e){var i=e.split(":"),r=""===i[0]?i[1]:n,o=""===i[0]?i[2]:i[0];delete t.data[r][o]})},history:function(e,i,o){r&&t.history.append(o?[n,e,i]:[n+":"+e,i])},props:o,raw:s};return e.isObject(i)&&a.set(i,!1),a},get:function(t,n,i){if(!(t.indexOf(":")<=0)){var r=t.split(":"),o=this.init(r[0]),s=r.slice(1).join(":");return e.isUndefined(n)||o.set(s,n,i),o.get(s)}},on:function(n,i){return!t.$event.on&&window.jQuery&&(t.$event=window.jQuery(window)),e.each(n.split(" "),function(n){t.$event.on(t.event(n),function(){e.isFunction(i)&&i.apply(this,e.toArray(arguments).slice(1))})}),t},off:function(n,i){return e.each(n.split(" "),function(e){i?t.$event.off(t.event(e),i):t.$event.off(t.event(e))}),t},event:function(t){return"app-props:"+e.toArray(arguments).join(":").replace(/app-props:/g,"")},history:{log:{pre:e.storage.session&&e.storage.session.getItem("app-props:history")||[],current:[]},reload:function(){if(t.history.log.pre.length){t.history.reloading=!0,console.log("History:",t.history.log.pre.length);var n=t.history.log.pre.slice(),i=function(){var r=n.shift(),o=JSON.parse(r,function(t,n){return/^xpath:\/\//.test(n)?document.querySelector(e.xpathToSelector(n)):n});if(o.length>2){console.log("trigger:",o);var s=t.init(o[0]);s.trigger.apply(t,[o[1]].concat(o[2]))}else console.log("props:",o),t.get.apply(t,o);return n.length?setTimeout(i,0):(t.history.log.current=t.history.log.pre.slice(),t.history.reloading=!1,void t.history.save())};i()}},append:function(e){t.history.reloading||(t.history.log.current.push(JSON.stringify(e)),t.history.save())},save:function(){e.storage.session&&e.storage.session.setItem(t.event("history"),t.history.log.current)}}};return t}(t),i=function(e){var t={fn:{init:function(){Node.prototype.removeAttr=NodeList.prototype.removeAttr=t.fn.removeAttr,Node.prototype.attr=NodeList.prototype.attr=t.fn.attr,Node.prototype.data=NodeList.prototype.data=t.fn.data},removeAttr:function(e){return this.forEach(function(t){t.removeAttribute(e)}),this},attr:function(n,i){var r=e.toArray(arguments);return r.length>2&&(r.length=2),t.fn.set.apply(this,r)},data:function(n,i){if(1===arguments.length&&e.isString(n))return t.fn.set.call(e.isNodeList(this)?this[0]:this,n,void 0,!0);var r={};return e.isObject(n)?e.extend(r,n,!0):r[n]=i,t.fn.set.call(this,r,void 0,!0),this},set:function(n,i,r){if(e.isNodeList(this))return 1===arguments.length&&e.isString(n)?this[0]?this[0].getAttribute(n):void 0:(this.forEach(function(e){t.fn.set.apply(e,this)}.bind(arguments)),this);if(r&&!this._dataset&&(this._dataset=e.cloneDeep(this.dataset)),1===arguments.length||r&&e.isUndefined(i)){if(e.isString(n))return r?this._dataset[n]:this.getAttribute(n);for(var o in n)r?this._dataset[o]=n[o]:this.setAttribute(o,n[o])}else r?this._dataset[n]=i:this.setAttribute(n,i);return this}}};return t.fn}(t),r=function(e){var t={fn:{init:function(){Node.prototype.addClass=NodeList.prototype.addClass=t.fn.add,Node.prototype.removeClass=NodeList.prototype.removeClass=t.fn.remove,Node.prototype.toggleClass=NodeList.prototype.toggleClass=t.fn.toggle,Node.prototype.hasClass=NodeList.prototype.hasClass=t.fn.contains},get:function(){return this.reduce(function(t,n){return t.concat(e.toArray(n.classList))},[])},set:function(n,i,r,o){return e.isNodeList(n)?n.forEach(function(e){o?o.apply(e,r):t.fn.set(e,i,this)}.bind(r)):e.toArray(r).join(" ").split(" ").forEach(function(e){n.classList[i](e)}),n},add:function(){return t.fn.set(this,"add",arguments)},remove:function(){return t.fn.set(this,"remove",arguments)},toggle:function(n,i){return t.fn.set(this,"add",arguments,function(){e.isIE?(e.isUndefined(i)?this.classList.contains(n):i)?this.classList.add(n):this.classList.remove(n):this.classList.toggle(n,i)})},contains:function(t,n){if(e.isNodeList(this)){var i;return this.forEach(function(e,r){e.classList.contains(t)?n&&i!==!1?i=!0:n||(i=!0):n&&(i=!1)}),!!i}return this.classList.contains(t)}}};return t.fn}(t),o=function(e){var t={types:{DragEvent:["drag","dragend","dragenter","dragleave","dragover","dragstart","drop"],Event:["change","input","invalid"],FocusEvent:["blur","focus"],KeyboardEvent:["keydown","keypress","keyup"],MouseEvent:["click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup"],TouchEvent:["touchcancel","touchend","touchenter","touchleave","touchmove","touchstart"],WheelEvent:["wheel"]},list:[],data:{},fn:{init:function(){NodeList.prototype.on=NodeList.prototype.addEventListener=t.fn.on.all,Node.prototype.on=window.on=t.fn.on.event,XMLHttpRequest.prototype.on=t.fn.on.xhr,NodeList.prototype.off=NodeList.prototype.removeEventListener=t.fn.off.all,Node.prototype.off=window.off=XMLHttpRequest.prototype.off=t.fn.off.event,NodeList.prototype.trigger=t.fn.trigger.all,Node.prototype.trigger=window.trigger=t.fn.trigger.event,t.types.list={ref:{}};for(var e in t.types)"list"!==e&&t.types[e].forEach(function(n){t.types.list[n]=window[e],t.types.list.ref[n]=e})},on:{all:function(e,t,n){return this.forEach(function(i){i.on(e,t||n,!!t&&n)}),this},event:function(n,i,r){return n.split(" ").forEach(function(n){var o=t.fn.type.e(n),s=t.fn.type.ns(n),a=function(n){var o=r?!!(n.delegateTarget=n.target.closest(i))&&n.target:this,s=n.detail||n.data,a=t.data[s];o&&(n.detail=0,(r||i).apply(o,a?e.toArray(arguments).concat(a):arguments))};t.list.push({$el:this,type:o,ns:s,fn:r||i,callback:a}),this.addEventListener(o,a)}.bind(this)),this},xhr:function(e,n){return t.fn.on.el.call(this,e,n),this}},off:{all:function(e,t){return this.forEach(function(e){e.off.apply(e,this)}.bind(arguments)),this},event:function(n,i){return i=arguments.length>1&&(i||!0),n.split(" ").forEach(function(n){if(n){var r=t.fn.type.e(n),o=t.fn.type.ns(n),s=e.filter(t.list,function(e,t){if(e.i=t,e.$el===this)return!(r&&e.type!==r||o&&e.ns.slice(-o.length)!==o||i&&e.fn!==i)}.bind(this));for(var a in s)t.list.splice(s[a].i,1),this.removeEventListener(s[a].type,s[a].callback)}}.bind(this)),this}},trigger:{all:function(e,t){return this.forEach(function(n){n.trigger(e,t)}),this},event:function(n,i){var r,o=+Math.random().toString().slice(2,11);t.data[o]=i,e.isIE?(r=document.createEvent(t.types.list.ref[n]||"Event"),r.initEvent(n,!0,!1),r.data=o,this.dispatchEvent(r)):(r=t.types.list[n]||CustomEvent,this.dispatchEvent(new r(n,{bubbles:!0,detail:o}))),delete t.data[o]}},type:{e:function(e){return e.replace(/\..*/,"")},ns:function(e){return e.replace(/^[^.]*\.?/,"")}}}};return t.fn}(t),s=function(e){var t={fn:{init:function(){Node.prototype.find=window.find=NodeList.prototype.find=t.fn.find,Node.prototype.parents=NodeList.prototype.parents=t.fn.parents,Node.prototype.path=NodeList.prototype.path=t.fn.path,Node.prototype.toJSON=Node.prototype.xpath=NodeList.prototype.xpath=t.fn.xpath,Node.prototype.closest=NodeList.prototype.closest=t.fn.closest},find:function(t){if(e.isNodeList(this)){var n="f"+(1e5*Math.random()|0);this.forEach(function(e){e.find(t).forEach(function(e){e.classList.add(n)})});var i=document.querySelectorAll("."+n);return i.forEach(function(e){e.classList.remove(n)}),i}var r=this===window?document:this;return r.querySelectorAll(t)},parents:function(t){if(e.isNodeList(this))return this.length>1?e.uniq(this.reduce(function(e,n){return e.concat(n.parents.call(this,t))},[])):this.parents.call(this[0],t);var n=this.path().slice(1);return t?n.filter(function(e){return e.is(t)}):n},path:function(t){if(e.isNodeList(this))return this.map(function(e){return e.path(t)});if(!this.$path||t){var n,i,r=this;for(this.$path=[],this.$xpath=[];r&&r!==document;r=r.parentNode){for(n=1,i=r.previousElementSibling;i;)i.tagName===r.tagName&&++n,i=i.previousElementSibling;this.$xpath.unshift(r.tagName+(n>1?"["+n+"]":"")),this.$path.push(r)}}return this.$path.slice()},xpath:function(t){return e.isNodeList(this)?this.map(function(e){return e.xpath(t)}):(this.path(t),"xpath://"+this.$xpath.slice(1).join("/").toLowerCase())},closest:function(t){return t?e.isNodeList(this)?this.length>1?e.uniq(this.reduce(function(e,n){return e.concat(n.closest.call(this,t))},[])):this.closest.call(this[0],t):e.find(this.path(),function(e){return e.is(t)}):[]}}};return t.fn}(t),a=function(e){var t={fn:{init:function(){NodeList.prototype.eq=t.fn.eq,Node.prototype.is=NodeList.prototype.is=t.fn.is,Node.prototype.clone=NodeList.prototype.clone=t.fn.clone,Node.prototype.before=NodeList.prototype.before=t.fn.before,Node.prototype.after=NodeList.prototype.after=t.fn.after,Node.prototype.prepend=NodeList.prototype.prepend=t.fn.prepend,Node.prototype.append=NodeList.prototype.append=t.fn.append,Node.prototype.text=NodeList.prototype.text=t.fn.text,Node.prototype.html=NodeList.prototype.html=t.fn.html,Node.prototype.val=NodeList.prototype.val=t.fn.val,Node.prototype.prop=NodeList.prototype.prop=t.fn.prop},el:function(n,i,r){if(e.isNodeList(n))n.forEach(function(e){t.fn.el(e,i,r)});else if(e.isString(r))return n.insertAdjacentHTML(i,r)},eq:function(e){return this[e]},is:function(t){var n=e.isNodeList(this)?this:[this];return n.reduce(function(n,i){return n||(e.isString(t)?e.isIE||i.msMatchesSelector?i.msMatchesSelector(t):i.matches(t):e.isNodeList(t)?t.is(i):t===i)},!1)},clone:function(){if(e.isNodeList(this)){var t=document.createDocumentFragment();return this.forEach(function(e){var n=e.cloneNode(!0);t.appendChild(n)}),t.childNodes}return this.cloneNode(!0)},val:function(e){return this.prop("value",e)},prop:function(t,n){var i=e.isNodeList(this)?this:[this];return 1===arguments.length&&e.isString(t)?(n=i[0]?i[0][t]:void 0,"true"===n||"false"!==n&&n):(e.isString(t)&&(t=e.object([t],[n])),i.forEach(function(e){for(var n in t)e[n]=t[n]}),this)},before:function(e){return t.fn.el(this,"beforebegin",e),this},after:function(e){return t.fn.el(this,"afterend",e),this},prepend:function(e){return t.fn.el(this,"afterbegin",e),this},append:function(e){return t.fn.el(this,"beforeend",e),this},text:function(t,n){var i=e.isNodeList(this)?this:[this];if(e.isUndefined(t)){var r;return i.reduce(function(e,t,o){var s=t[n?"innerHTML":"textContent"];return r=(0===o||s===r)&&s,o===i.length-1&&r?r:e+s},"")}return i.forEach(function(e){e[n?"innerHTML":"textContent"]=t}),this},html:function(e){return this.text(e,!0)}}};return t.fn}(t),u=function(e,t,n,i,r,o){var s={init:function(){o.init(),window.jQuery||(this.init=o.noop,window.$=function(e){return o.isString(e)?document.querySelectorAll(e):e},NodeList.prototype.__proto__=Array.prototype,e.init(),t.init(),n.init(),i.init(),r.init())}};return s}(i,r,o,s,a,t),c=function(e){var t={get:function(t){return t.type="GET",t.url=t.url||"",t.data&&(t.data=e.isString(t.data)?t.data:e.serialise(t.data),t.url+=(t.url.indexOf("?")>=0?"&":"?")+t.data),this.request(t)},post:function(e){return e.type="POST",e.url=e.url||"",this.request(e)},request:function(t){var n=new XMLHttpRequest;return type=t.type||"GET",callback=function(t,i,r){if(e.isFunction(t)){if(r||(r=i,i=r.target.response),e.isString(i)&&/\[|\{/.test(i.slice(0,1))||!isNaN(i))try{i=JSON.parse(i)}catch(e){}t(i,r,n)}},n.addEventListener("load",function(e){200!==e.target.status&&callback(t.error,e),callback(t.complete,e)}),n.addEventListener("progress",function(e){callback(t.progress,e.lengthComputable?e.loaded/e.total:void 0,e)}),n.addEventListener("error",function(e){callback(t.error,e)}),n.addEventListener("abort",function(e){callback(t.abort,e)}),n.open(type,t.url),t.headers!==!1&&e.each(t.headers,function(e,t){n.setRequestHeader(t,e)}),"GET"!==type&&t.data?(t.header!==!1&&n.setRequestHeader("Content-Type",t.header||"application/json;charset=UTF-8"),n.send(e.isString(t.data)?t.data:JSON.stringify(t.data))):n.send(),n}};return t}(t),p=function(e,t,n,i){var r={extend:function(r){if(t.init(),r.name){var o=e.init(r.name,r.props,r.history);n.extend(r,o),n.each(n.omit(o,"props"),function(e,t){Object.defineProperty(r,t,{enumerable:!1,value:e})})}else console.warn("A view/module is unnamed - it will be unable to communicate:\r",r);return Object.defineProperty(r,"_fn",{enumerable:!1,value:n.cloneDeep(r.fn)}),Object.defineProperty(r,"XHR",{enumerable:!1,value:i}),Object.defineProperty(r,"_",{enumerable:!1,value:n}),r.Props=e,this.wrap(r.fn,r)},wrap:function(e,t){return n.each(e,function(i,o){!n.isObject(i)||n.isFunction(i)||n.isNodeList(i)||n.isJquery(i)?n.isFunction(i)&&(e[o]=function(e){return i.apply(t,arguments)}):r.wrap(i,t)}),e}};return r}(n,u,t,c),f=function(e,t){var n={extend:function(i){var r=e.extend(i);return i.uid||(i.uid=t.randomString(16)),i.bind=n.$el.bind.bind(i),i.unbind=n.$el.unbind.bind(i),i.autoBind=n.$el.autoBind.bind(i),n.$el.set(i),r},$el:{set:function(e){if(e.el=e.el||"body",e.$el=t.isString(e.el)?$(e.el):t.isDomSelection(e.el)?e.el:!!t.isString(e.el.selector)&&$(e.el.selector),!e.$el)return console.warn('View "'+e.name+'": element is incorrectly defined')},autoBind:function(e,n){n=n||":router",this.on(n+":"+(e||this.name),function(){(this.fn.render||t.noop).apply(this,arguments),this.bind()}.bind(this)),this.on(n+":before",this.unbind)},bind:function(e){e!==!0&&this.$el&&this.$el.length||n.$el.set(this),this.bindings&&this.unbind(!1),this.trigger("prebind"),this.bindings=[],t.each(this.el.bind,function(e,i){var r,o;if(t.isString(e)&&(e={selector:e}),e.selector)o={el:$(e.selector),prop:i,selector:e.selector,node:!0},this.set(o.prop,o.el,!1);else if(t.isObject(e)){r=$(i),o={input:r.is("input, textarea")||r.prop("contentEditable")===!0,prop:e.to,$el:r,selector:i,fn:function(n){o.$el.forEach(function(i){if(o.current!==i){var r=t.isFunction(s)?s(n,i,!0):n;t.isUndefined(r)||i.prop(e.set,r)}})}},e.set=e.set||(o.input?"value":"textContent");var s=!!e.fn&&e.fn.split(":").reduce(function(e,n){return!!t.isObject(e)&&e[n]},this.fn),a=t.isUndefined(e.val)?this.Props.get(this.name+":"+o.prop)||o.$el.prop(e.set):e.val;this.on(o.prop,o.fn),this.Props.get(this.name+":"+o.prop,a,!0),o.input&&this.$el.on(n.$el.event("input change",this),o.selector,function(n){o.current=n.target;var i=n.target[e.set],r=t.isFunction(s)?s(i,n.target,!1):i;this.set(o.prop,r),o.current=!1}.bind(this))}o&&e.on&&t.each(e.on,function(e,t){n.$el.fn(t,o.selector,e,this)},this),this.bindings.push(o)},this),t.each(this.el.on,function(e,t){n.$el.fn(t,!1,e,this)},this),this.trigger("bind")},fn:function(e,i,r,o){t.isObject(r)&&r.delegate&&r.fn&&(i=t.isString(i)?i+" "+r.delegate:r.delegate,r=r.fn),t.isString(r)&&(r=r.split(":").reduce(function(e,n){return!!t.isObject(e)&&e[n]},o.fn)),t.isFunction(r)&&(e=n.$el.event(e,o),r=r.bind(o),i?o.$el.on(e,i,r):o.$el.on(e,r))},unbind:function(e){this.bindings&&(e!==!1&&this.trigger("preunbind"),this.$el.off(".bind-"+(this.uid||this.name)),t.each(this.bindings,function(e){e.node?this.unset(e.prop):this.off(e.prop,e.fn)},this),this.bindings=!1,e!==!1&&this.trigger("unbind"))},event:function(e,t){return e.replace(/( |$)/g,".bind-"+(t.uid||t.name)+"$1")}}};return n}(p,t),l=function(e,t){var n='<% if( obj.missing ){ %>Missing a BASE tag<% }else{ %>BASE tag is incorrect<% } %>. If this is a production site include the following below your <title>:\n<base href="<%= base %>">',i={extend:function(n){return t.defaultsDeep(n.fn,i.fn),n.start=function(){this.fn.start.apply(this,arguments)},e.extend(n)},fn:{start:function(e,i){window.onpopstate=function(e){e.state&&this.fn.route.href({href:e.state.href,replace:!0})}.bind(this);var r=$("head base"),o=this._.cookie("base");this.props.base=e||this.props.base||o||r.attr("href")||window.location.origin,0!==this.props.base.indexOf(location.origin)&&(this.props.base=location.origin+this.props.base),r.length?r.attr("href")!==this.props.base&&(r.attr("href",this.props.base),o||console.warn(t.template(n)({base:this.props.base}))):($("head title").after('<base href="'+this.props.base+'">'),o||console.warn(t.template(n)({base:this.props.base,missing:!0}))),this.props.title=$("head title").text(),t.each(this.props.routes,this.fn.route.set),this.on("href",this.fn.route.href),$("body").on("click","a:not([data-external])",this.fn.anchor),this.trigger("start"),this.set("href",{href:i||location.href.replace(this.props.base,""),replace:!0},!0)},anchor:function(e){if(0===e.delegateTarget.href.indexOf(this.props.base)){var t=e.delegateTarget,n=t.getAttribute("href").replace(/^\//,"");http="http"===t.href.slice(0,4),target=t.target||"_self","_self"!==target||"#"===n.slice(0,1)||!http||e.ctrlKey||e.metaKey||(e.preventDefault(),this.fn.route.href(n))}},route:{href:function(e){t.isString(e)?e={href:e}:this.set("href",e.href,!1);var n,i,r,o=e.href,s=[],a=t.find(this.props.routes,function(e){s=o.match(e.re);for(var t in s)s[t]=isNaN(s[t])?s[t]:+s[t];return s})||{};s||(s=[]),n=[a.name].concat(s.slice(1)),i=e.replace||[o,this.props.base+o].indexOf(window.location.href)>=0,r=e.trigger!==!1,r&&this.trigger.apply(this,["before"].concat(n)),window.history.pushState||window.open(o,"_self"),i?window.history.replaceState({href:o},a.title,o):window.history.pushState({href:o},a.title,o),document.title=a.title,$("body").attr("data-route",a.name),this.set("current",{href:o,name:a.name,args:s.slice(1)},r),r&&this.trigger.apply(this,n),r&&this.trigger.apply(this,["after"].concat(n))},set:function(e,n,i){t.isObject(e)||(e={route:e}),e.name=n,e.title=(e.title||n.slice(0,1).toUpperCase()+n.slice(1))+(this.props.delimeter||" | ")+this.props.title,e.re=e.re||t.isRegExp(e.route)?e.route:this.fn.route.re(e.route),i[n]=e},re:function(e){var t={optional:/\((.*?)\)/g,named:/(\(\?)?:\w+/g,path:/\*\w+/g,escape:/[\-{}\[\]+?.,\\\^$|#\s]/g};return e=e.replace(t.escape,"\\$&").replace(t.optional,"(?:$1)?").replace(t.named,function(e,t){return t?e:"([^/?]+)"}).replace(t.path,"([^?]*?)"),new RegExp("^"+e+"(?:\\?[\\s\\S]*)?$")}}}};return i}(p,t),d=function(t,n,i,r,o,s){var a={version:"0.1.2",View:t,Module:n,Router:i,Props:r,_:o,XHR:s};return"undefined"!=typeof e&&(e=a),a}(f,p,l,n,t,c)}(),e},"MediumFramework"),n("controller/router",["framework"],function(e){return e.Router.extend({name:"router",props:{routes:{home:{title:"Save our Future",route:""},adani:{title:"What is Adani?",route:"what-is-adani"},involved:{title:"How to get involved",route:"how-to-get-involved"},events:"local-events",news:"in-the-news",missing:{title:"Save our Future",route:"*missing"}}},fn:{init:function(){this.on(":router:before",this.fn.on.before),this.start()},on:{before:function(){$("body").attr("data-route-prev",this.props.current?this.props.current.name:"")}}}})}),n("text",["module"],function(e){"use strict";var n,i,r,o,s,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,p="undefined"!=typeof location&&location.href,f=p&&location.protocol&&location.protocol.replace(/\:/,""),l=p&&location.hostname,d=p&&(location.port||void 0),h={},g=e.config&&e.config()||{};return n={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:g.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){n=a[t];try{e=new ActiveXObject(n)}catch(e){}if(e){a=[n];break}}return e},parseName:function(e){var t,n,i,r=!1,o=e.indexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return o!==-1&&(!s||o>1)?(t=e.substring(0,o),n=e.substring(o+1,e.length)):t=e,i=n||t,o=i.indexOf("!"),o!==-1&&(r="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:t=i),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,i,r){var o,s,a,u=n.xdRegExp.exec(e);return!u||(o=u[2],s=u[3],s=s.split(":"),a=s[1],s=s[0],!(o&&o!==t||s&&s.toLowerCase()!==i.toLowerCase()||(a||s)&&a!==r))},finishLoad:function(e,t,i,r){i=t?n.strip(i):i,g.isBuild&&(h[e]=i),r(i)},load:function(e,t,i,r){if(r.isBuild&&!r.inlineText)return void i();g.isBuild=r.isBuild;var o=n.parseName(e),s=o.moduleName+(o.ext?"."+o.ext:""),a=t.toUrl(s),u=g.useXhr||n.useXhr;return 0===a.indexOf("empty:")?void i():void(!p||u(a,f,l,d)?n.get(a,function(t){n.finishLoad(e,o.strip,t,i)},function(e){i.error&&i.error(e)}):t([s],function(e){n.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)}))},write:function(e,t,i,r){if(h.hasOwnProperty(t)){var o=n.jsEscape(h[t]);i.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,t,i,r,o){var s=n.parseName(t),a=s.ext?"."+s.ext:"",u=s.moduleName+a,c=i.toUrl(s.moduleName+a)+".js";n.load(u,i,function(t){var i=function(e){return r(c,e)};i.asModule=function(e,t){return r.asModule(e,c,t)},n.write(e,u,i,o)},o)}},"node"===g.env||!g.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=t.nodeRequire("fs"),n.get=function(e,t,n){try{var r=i.readFileSync(e,"utf8");0===r.indexOf("\ufeff")&&(r=r.substring(1)),t(r)}catch(e){n(e)}}):"xhr"===g.env||!g.env&&n.createXhr()?n.get=function(e,t,i,r){var o,s=n.createXhr();if(s.open("GET",e,!0),r)for(o in r)r.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),r[o]);g.onXhr&&g.onXhr(s,e),s.onreadystatechange=function(n){var r,o;4===s.readyState&&(r=s.status,r>399&&r<600?(o=new Error(e+" HTTP status: "+r),o.xhr=s,i(o)):t(s.responseText),g.onXhrComplete&&g.onXhrComplete(s,e))},s.send(null)}:"rhino"===g.env||!g.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?n.get=function(e,t){var n,i,r="utf-8",o=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),u="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(s),n.append(i);u=String(n.toString())}finally{a.close()}t(u)}:("xpconnect"===g.env||!g.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,o=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,n.get=function(e,t){var n,i,a,u={};s&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),n.init(a,1,0,!1),i=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),i.init(n,"utf-8",n.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),u),i.close(),n.close(),t(u.value)}catch(e){throw new Error((a&&a.path||"")+": "+e)}}),n}),n("text!template/home.html",[],function(){
return'<main class="main" role="main">\n\n\n</main>\n<!-- /main -->\n'}),n("view/home",["framework","text!template/home.html"],function(e,t){return e.View.extend({name:"home",el:{selector:"body",bind:{"$el:main":".main"},on:{}},props:{},fn:{init:function(){this.bind()},on:{},render:function(){}}})}),n("view/adani",["framework","text!template/home.html"],function(e,t){return e.View.extend({name:"adani",el:{selector:".main",bind:{"$el:main":".main"},on:{}},props:{},fn:{init:function(){this.autoBind()},render:function(){this.bind();var e=window.pageYOffset||document.documentElement.scrollTop,t=e+$(".facebook").eq(0).getBoundingClientRect().top;window.scroll(0,t-$(".nav--outer").eq(0).clientHeight),$("#nav--toggle").eq(0).checked=!1}}})}),n("view/hero",["framework"],function(e,t){return e.View.extend({name:"header",el:{selector:".header",bind:{"$el:hero":".hero","$el:title":".hero--items"},on:{}},props:{},fn:{init:function(){this.bind(),this.fn.update()},update:function(){clearTimeout(this.props.timeout),this.props.$el.title.removeClass("reverse"),this.props.$el.title.eq(0).dataset.active=+this.props.$el.title.eq(0).dataset.active%5+1,this.props.timeout=setTimeout(function(){this.props.$el.title.addClass("reverse"),this.props.timeout=setTimeout(this.fn.update,1500)}.bind(this),7e3)},render:function(){}}})}),n("view/video",["framework"],function(e){return e.View.extend({name:"video",el:{selector:".video",bind:{"$el:iframe":".video iframe","$el:player":".video video"},on:{}},props:{},fn:{init:function(){this.bind(),this.props.$el.player.on("playing",this.fn.on.ready),$(window).on("resize",this.fn.on.resize),this.fn.on.resize()},on:{resize:function(){var e=this.props.$el.player.eq(0),t=e.dataset.srcSizes.split(",").reduce(function(e,t){if(e)return e;var n=t.split("|"),i=n[1]?+n[1]:0;return window.innerWidth<=i?n[0]||"":e},"");t!==this.props.size&&(this.props.size=t,e.dataset.size=t,e.muted=!0,e.src=t?e.dataset.src.replace(/\.[^.]+$/,"_"+t+"$&"):e.dataset.src)},ready:function(){this.$el.eq(0).dataset.ready=""}}}})}),n("view/signup",["framework"],function(e,t){return e.View.extend({name:"signup",el:{selector:"body",bind:{"$el:signup:container":".signup","$el:signup:form":".signup form","$el:signup:name":"#name","$el:signup:email":"#email","$el:signup:botcheck":"#noname"},on:{submit:{delegate:".signup form",fn:"on:submit"},"focusin.signup focusout.signup":{delegate:".signup input",fn:"on:focus"},"input.signup":{delegate:".signup input",fn:"on:input"},"click.reset":{delegate:".overlay--error .button--generic",fn:"on:reset"}}},props:{},fn:{init:function(){this.bind(),this.on(":router:involved",this.fn.render)},on:{focus:function(e){e&&"focusin"==e.type?this.props.$el.signup.container.addClass("focus"):this.props.$el.signup.container.removeClass("focus")},input:function(e){this.props.name=this.props.$el.signup.name.eq(0).value,this.props.email=this.props.$el.signup.email.eq(0).value,this.props.name||this.props.email?this.props.$el.signup.container.addClass("open"):this.props.$el.signup.container.removeClass("open"),e&&(e.target.parentElement.dataset.value=e.target.value)},submit:function(e){if(e.preventDefault(),this.props.name&&this.props.email&&!this.props.$el.signup.botcheck.eq(0).value){var t=this.props.name.replace(/^(\S*)\s?.*/,"$1").toLowerCase(),n=this.props.name.replace(/^(\S*)\s?(.*)/,"$2").toLowerCase(),i={FNAME:t.slice(0,1).toUpperCase()+t.slice(1),LNAME:n.split(" ").map(function(e){return e.slice(0,1).toUpperCase()+e.slice(1)}).join(" "),EMAIL:this.props.email.toLowerCase()};this.fn.state("loading");var r=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,5),o=document.createElement("script");window[r]=function(e){delete window[r],e.result&&"success"===e.result?this.fn.state("success"):this.fn.state("error")}.bind(this),o.src=[this.props.$el.signup.form.eq(0).action+r,this._.serialise(i)].join("&"),$("head").eq(0).appendChild(o)}},reset:function(e){e.preventDefault(),this.fn.state("")}},state:function(e){this.props.$el.signup.container.eq(0).dataset.state=e},render:function(){this.props.$el.signup.container.eq(0).scrollIntoView({behaviour:"smooth"}),$("#nav--toggle").eq(0).checked=!1}}})}),n("app",["framework","controller/router","view/home","view/adani","view/hero","view/video","view/signup"],function(e,t,n,i,r,o,s){return e.Module.extend({name:"app",fn:{init:function(){n.init(),i.init(),r.init(),o.init(),s.init(),t.init()}}})}),function(e){e.config({urlArgs:"bust="+(new Date).getTime(),waitSeconds:0,paths:{framework:"vendor/medium-framework-0.1.2",text:"vendor/require/require.text-2.0.10",template:"../templates"}}),e(["app"],function(e){e.init()})}(t),n("_require",function(){}),t(["_require"])}();